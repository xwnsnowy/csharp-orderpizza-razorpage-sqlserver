@page
@model OrderFoodWeb.Pages.Cart.IndexModel
@{
    ViewData["Title"] = "Cart";

    var cartProducts = new List<dynamic>
    {
        new { Id = 1, Name = "Margherita Pizza", Image = "~/images/pizza1.jpg", Size = "Large", Extras = new List<dynamic> { new { Name = "Extra Cheese", Price = 2.0 } }, Price = 15.0 },
        new { Id = 2, Name = "Pepperoni Pizza", Image = "~/images/pizza2.jpg", Size = "Medium", Extras = new List<dynamic> { new { Name = "Extra Pepperoni", Price = 3.0 } }, Price = 18.0 }
    };

    // double subtotal = cartProducts.Sum(p => (double)p.Price + p.Extras.Sum(e => (double)e.Price));
    double deliveryFee = 5.0;
    double total = 5000;

    var address = new { Phone = "", StreetAddress = "", PostalCode = "", City = "", Country = "" };
}
<section class="mt-8">
    <div class="text-center">
        <h1 class="main-header text-primary" style="font-style:italic">Cart</h1>
    </div>
    <div class="mt-8 grid gap-8 grid-cols-2">
        <div>
            @if (cartProducts.Count == 0)
            {
                <div class="text-center text-gray-500">Your shopping cart is empty 😔</div>
            }
            else
            {
                @foreach (var product in cartProducts)
                {
                    <div class="flex items-center gap-4 border-b py-4">
                        <div class="w-24">
                            <img src="@product.Image" alt="@product.Name" class="w-full" />
                        </div>
                        <div class="flex-grow">
                            <h3 class="font-semibold">@product.Name</h3>
                            @if (!string.IsNullOrEmpty(product.Size))
                            {
                                <div class="text-sm">Size: <span>@product.Size</span></div>
                            }
                            @if (product.Extras != null && product.Extras.Count > 0)
                            {
                                <div class="text-sm text-gray-500">
                                    @foreach (var extra in product.Extras)
                                    {
                                        <div>@extra.Name $@extra.Price</div>
                                    }
                                </div>
                            }
                        </div>
                        <div class="text-lg font-semibold">
                            5000
                        </div>
                        <div class="ml-2">
                            <button type="button" class="p-2" onclick="removeProduct(@product.Id)">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </div>
                    </div>
                }
                <div class="py-2 pr-16 flex justify-end items-center">
                    <div class="text-gray-500">
                        Subtotal:<br />
                        Delivery:<br />
                        Total:
                    </div>
                    <div class="font-semibold pl-2 text-right">
                        5000<br />
                        5000<br />
                        5000
                    </div>
                </div>
            }
        </div>
        <div class="bg-gray-100 p-4 rounded-lg">
            <h2>Checkout</h2>
            <form method="post" asp-page-handler="ProceedToCheckout">
                <label>Phone</label>
                <input type="tel" placeholder="Phone number" value="@address.Phone" />

                <label>Street address</label>
                <input type="text" placeholder="Street address" value="@address.StreetAddress" />

                <div class="grid grid-cols-2 gap-2">
                    <div>
                        <label>Postal code</label>
                        <input type="text" placeholder="Postal code" value="@address.PostalCode" />
                    </div>
                    <div>
                        <label>City</label>
                        <input type="text" placeholder="City" value="@address.City" />
                    </div>
                </div>

                <label>Country</label>
                <input type="text" placeholder="Country" value="@address.Country" />

                <button type="submit" class="btn btn-primary mt-4">Pay $@total</button>
            </form>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        function removeProduct(productId) {
            // Implement your product removal logic here
            alert('Remove product with ID: ' + productId);
        }
    </script>
}

<link rel="stylesheet" href="~/css/cart.css" />
